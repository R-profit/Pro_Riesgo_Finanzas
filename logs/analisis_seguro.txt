[INFO] 2025-10-30 19:07:48 - Descargando datos de GC=F desde 2024-01-01 hasta 2025-10-01...
[INFO] 2025-10-30 19:07:49 - Datos descargados correctamente: 440 registros.
[INFO] 2025-10-30 19:07:49 - Función 'load_data' ejecutada correctamente.
[INFO] 2025-10-30 19:07:49 - Calculando SMA (Simple Moving Average)...
[ERROR] 2025-10-30 19:07:49 - Error en 'sma': 'Adj Close'
Traceback (most recent call last):
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Adj Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\rafae\Desktop\IBM-SENA\algotirmos UniAndes\todos juntos\algoritmos\Pro_Riesgo_Finanzas\.venv\bot _trading\indicadores\indicadores_tecnicos.py", line 51, in safe_run
    result = func(*args, **kwargs)
  File "c:\Users\rafae\Desktop\IBM-SENA\algotirmos UniAndes\todos juntos\algoritmos\Pro_Riesgo_Finanzas\.venv\bot _trading\indicadores\indicadores_tecnicos.py", line 115, in sma
    self.df['SMA_short'] = self.df['Adj Close'].rolling(window=short).mean()
                           ~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\frame.py", line 4112, in __getitem__
    return self._getitem_multilevel(key)
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\frame.py", line 4170, in _getitem_multilevel
    loc = self.columns.get_loc(key)
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\indexes\multi.py", line 3059, in get_loc
    loc = self._get_level_indexer(key, level=0)
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\indexes\multi.py", line 3410, in _get_level_indexer
    idx = self._get_loc_single_level_index(level_index, key)
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\indexes\multi.py", line 2999, in _get_loc_single_level_index
    return level_index.get_loc(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'Adj Close'

[INFO] 2025-10-30 19:07:49 - Calculando EMA (Exponential Moving Average)...
[ERROR] 2025-10-30 19:07:49 - Error en 'ema': 'Adj Close'
Traceback (most recent call last):
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Adj Close'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\rafae\Desktop\IBM-SENA\algotirmos UniAndes\todos juntos\algoritmos\Pro_Riesgo_Finanzas\.venv\bot _trading\indicadores\indicadores_tecnicos.py", line 51, in safe_run
    result = func(*args, **kwargs)
  File "c:\Users\rafae\Desktop\IBM-SENA\algotirmos UniAndes\todos juntos\algoritmos\Pro_Riesgo_Finanzas\.venv\bot _trading\indicadores\indicadores_tecnicos.py", line 121, in ema
    self.df['EMA_short'] = self.df['Adj Close'].ewm(span=short, adjust=False).mean()
                           ~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\frame.py", line 4112, in __getitem__
    return self._getitem_multilevel(key)
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\frame.py", line 4170, in _getitem_multilevel
    loc = self.columns.get_loc(key)
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\indexes\multi.py", line 3059, in get_loc
    loc = self._get_level_indexer(key, level=0)
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\indexes\multi.py", line 3410, in _get_level_indexer
    idx = self._get_loc_single_level_index(level_index, key)
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\indexes\multi.py", line 2999, in _get_loc_single_level_index
    return level_index.get_loc(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'Adj Close'

[INFO] 2025-10-30 19:07:49 - Calculando Bandas de Bollinger...
[ERROR] 2025-10-30 19:07:49 - Error en 'bollinger': Data must be 1-dimensional, got ndarray of shape (440, 1) instead
Traceback (most recent call last):
  File "c:\Users\rafae\Desktop\IBM-SENA\algotirmos UniAndes\todos juntos\algoritmos\Pro_Riesgo_Finanzas\.venv\bot _trading\indicadores\indicadores_tecnicos.py", line 51, in safe_run
    result = func(*args, **kwargs)
  File "c:\Users\rafae\Desktop\IBM-SENA\algotirmos UniAndes\todos juntos\algoritmos\Pro_Riesgo_Finanzas\.venv\bot _trading\indicadores\indicadores_tecnicos.py", line 128, in bollinger
    self.df['BOL_M'] = bb.bollinger_mavg()
                       ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\ta\volatility.py", line 108, in bollinger_mavg
    return pd.Series(mavg, name="mavg")
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\series.py", line 587, in __init__
    data = sanitize_array(data, index, dtype, copy)
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\construction.py", line 630, in sanitize_array
    return sanitize_array(
        data,
    ...<3 lines>...
        allow_2d=allow_2d,
    )
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\construction.py", line 656, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\construction.py", line 715, in _sanitize_ndim
    raise ValueError(
        f"Data must be 1-dimensional, got ndarray of shape {data.shape} instead"
    )
ValueError: Data must be 1-dimensional, got ndarray of shape (440, 1) instead

[INFO] 2025-10-30 19:07:49 - Calculando MACD (Moving Average Convergence Divergence)...
[ERROR] 2025-10-30 19:07:49 - Error en 'macd': Data must be 1-dimensional, got ndarray of shape (440, 1) instead
Traceback (most recent call last):
  File "c:\Users\rafae\Desktop\IBM-SENA\algotirmos UniAndes\todos juntos\algoritmos\Pro_Riesgo_Finanzas\.venv\bot _trading\indicadores\indicadores_tecnicos.py", line 51, in safe_run
    result = func(*args, **kwargs)
  File "c:\Users\rafae\Desktop\IBM-SENA\algotirmos UniAndes\todos juntos\algoritmos\Pro_Riesgo_Finanzas\.venv\bot _trading\indicadores\indicadores_tecnicos.py", line 136, in macd
    self.df['MACD'] = macd.macd()
                      ~~~~~~~~~^^
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\ta\trend.py", line 129, in macd
    return pd.Series(
           ~~~~~~~~~^
        macd_series, name=f"MACD_{self._window_fast}_{self._window_slow}"
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\series.py", line 587, in __init__
    data = sanitize_array(data, index, dtype, copy)
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\construction.py", line 630, in sanitize_array
    return sanitize_array(
        data,
    ...<3 lines>...
        allow_2d=allow_2d,
    )
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\construction.py", line 656, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "C:\Users\rafae\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\construction.py", line 715, in _sanitize_ndim
    raise ValueError(
        f"Data must be 1-dimensional, got ndarray of shape {data.shape} instead"
    )
ValueError: Data must be 1-dimensional, got ndarray of shape (440, 1) instead

[INFO] 2025-10-30 19:07:49 - Función 'compute_all' ejecutada correctamente.
[INFO] 2025-10-30 19:07:49 - ✅ Pipeline ejecutado correctamente.
